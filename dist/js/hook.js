function myrefresh(){var a=window.location.href.split(".")[0];if(console.log(a),"http://fanshu"==a)var s="./log.json";else var s="//hook.canisminor.cc/log.json";$.getJSON(s,function(a){hook_client(a,"div#client"),hook_webhook(a,"div#webhook")}),console.log("xmhook load")}function hook_client(a,s){var s=$(s),e="";$.each(a.client,function(s){var t=a.client[s].data,o=a.client[s].time,i=a.client[s].url.replace("/","");e+="<div class='w-card'><div class='w-avatar'><img src='";var r=RegExp("http").test(t.user.avatar);e+=r?t.user.avatar:"https://coding.net"+t.user.avatar,e+="'></div><div class='w-box'><div class='w-title'>"+t.event+":<a href='"+t.repository.web_url+"'>"+t.repository.name+"</a></div><div class='w-time'><span>"+t.ref.split("/")[2]+"</span>"+o+"</div>";for(s in t.commits)e+="<a class='w-message' href='"+t.commits[s].web_url+"'>"+t.commits[s].short_message+"</a><div class='w-author'>committer: <span>"+t.commits[s].committer.name+"</span></div>";e+="</div>";for(var s=0;s<projects.length;s++)i==projects[s]&&(e+="<div class='auto-build'>客户端更新</div>");e+="</div>"}),e||(e="<div class='w-card w-null'>暂无数据</div>"),s.html(e)}function hook_webhook(a,s){var s=$(s),e="";$.each(a.webhook,function(s){var t=a.webhook[s].data,o=a.webhook[s].time,i=a.webhook[s].url.replace("/","");e+="<div class='w-card'><div class='w-avatar'><img src='";var r=RegExp("http").test(t.user.avatar);e+=r?t.user.avatar:"https://coding.net"+t.user.avatar,e+="'></div><div class='w-box'><div class='w-title'>"+t.event+":<a href='"+t.repository.web_url+"'>"+t.repository.name+"</a></div><div class='w-time'><span>"+t.ref.split("/")[2]+"</span>"+o+"</div>";for(s in t.commits)e+="<a class='w-message' href='"+t.commits[s].web_url+"'>"+t.commits[s].short_message+"</a><div class='w-author'>committer: <span>"+t.commits[s].committer.name+"</span></div>";e+="</div>";for(var s=0;s<projects.length;s++)i==projects[s]&&(e+="<div class='auto-build'>自动部署</div>");e+="</div>"}),e||(e="<div class='w-card w-null'>暂无数据</div>"),s.html(e)}var projects=["client","server","hook","website"];$(function(){myrefresh()});